<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>Homepage - BrainSprint</title>
  <link rel="icon" href="../images/brain.png">
  <link rel="stylesheet" href="../css/brain_style.css">
  <link rel="stylesheet" href="../css/homepage_style.css">
  <script src="https://www.gstatic.com/firebasejs/5.5.8/firebase.js"></script>
  <script type="text/javascript" src="../js/setup-firebase.js"></script>
  <script src="../js/jquery-3.3.1.js"></script>
</head>

<body>
  <div id="div_pagewrap">
    <div class="div_top_banner">
      <h1 id="logo_name">BrainSprint</h1>
      <!-- add the nav bar for the page sections -->
    </div>

    <!--BrainSprint Thing  -->
    <div class="div_main_cont">
      <div class="min_cont">
        <h1 class="page_header">YOUR ONLINE BRAINSTORMING PLATFORM</h2>
          <div id="div_roomButtons">
            <button id="button_enter" onclick="join_room_pop()" class="button_style">Enter a Room</button>
            <a href="./login.html"><button id="button_create" class="button_style">Create a Room</button></a>
          </div>
          <div id="div_brainsprintLogo">
            <img src="../images/brain.png" alt="The brainsprint logo" />
          </div>
      </div>
    </div>

    <!-- What is BrainSprint -->
    <div class="div_what_cont">
      <h1 class="page_header">What is BrainSprint?</h1>
      <div class="what_cont">
        <img src="../images/laptop.jpg" alt="laptop" id="what_img">
        <div class="what_text">
          <p class="p_texts">BrainSprint is an online brainstorming platform equipped with analytical tools, allowing user to save time and form great ideas.</p>
        </div>
      </div>
    </div>

    <!-- How it Works -->
    <div class="div_how_cont">
      <h1 class="page_header">How it Works</h1>

      <div class="how_cont">
        <div id="how_1" class="how_num">
          <div class="how_img_cont">
            <img src="../images/create.png" alt="create" class="img_pop">
          </div>
          <div class="what_text">
            <p class="p_texts">Create a Room</p>
          </div>
        </div>

        <div id="how_2" class="how_num">
          <div class="how_img_cont">
            <img src="../images/roomnumber.png" alt="roomnumber" class="img_pop">
          </div>
          <div class="what_text">
            <p class="p_texts">Send out the Room Code</p>
          </div>
        </div>

        <div id="how_3" class="how_num">
          <div class="how_img_cont">
            <img src="../images/activity.png" alt="activity" class="img_pop">
          </div>
          <div class="what_text">
            <p class="p_texts">Do the Activity</p>
          </div>
        </div>

        <div id="how_4" class="how_num">
          <div class="how_img_cont">
            <img src="../images/analytics.png" alt="analytics" class="img_pop">
          </div>
          <div class="what_text">
            <p class="p_texts">See the Analytics</p>
          </div>
        </div>
      </div>
    </div>

    <!-- HOW TO CREATE A ROOM -->
    <div class="div_create_cont">
      <h1 class="page_header">How to Create a Room</h1>

      <div class="create_cont">
        <div class="create_steps">
          <img src="../images/account.png" alt="account">
          <div class="create_text">
            <p class="p_texts">Team Leader creates an account</p>
          </div>
        </div>

        <div class="create_steps">
          <img src="../images/addroom.png" alt="addroom">
          <div class="create_text">
            <p class="p_texts">Go to the 'Your Room' tab in the dashboard, and click on the plus button</p>
          </div>
        </div>

        <div class="create_steps">
          <img src="../images/createroom.png" alt="createroom">
          <div class="create_text">
            <p class="p_texts">Enter the Room Name, Topics, and the duration for each topic. Then click 'Create' to make your room</p>
          </div>
        </div>

        <div class="create_steps">
          <img src="../images/roomnumber.png" alt="dummy">
          <div class="create_text">
            <p class="p_texts">Send the room code to your team</p>
          </div>
        </div>
      </div>
    </div>

    <!-- JOIN ROOM -->

    <div class="div_join_cont">
      <h1 class="page_header">Join a Room</h1>

      <div class="join_cont">
        <div class="join_with_account">
          <h2>With an Account</h2>
          <img src="../images/joinwith.png" alt="joinwith">
          <div class="create_text">
            <p class="p_texts">Go to the 'Join Room' tab and click on the plus button. Then enter the Room Code in the textbox.</p>
          </div>
        </div>

        <div class="join_without_account">
          <h2>Without an Account</h2>
          <img src="../images/joinwithout.png" alt="joinwithout">
          <div class="create_text">
            <p class="p_texts">Click on the 'Enter a Room' button and enter your Name and Room Code</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Join Room Popup -->
  <div class="join_room_popup">
    <!-- Join Room Popup Content -->
    <div class="join_room_popup_content">
      <span class="close" onclick="close_pop()">&times;</span>
      <form class="form_join_room">
        <p>Enter a Room?</p>
        <!-- <legend>Enter Room Number</legend> -->
        <input id="input_name" type="text" name="name" placeholder="Enter Your Name" />
        <input id="input_number" type="text" name="join_number" placeholder="Enter Room Number" />
        <button id="join_button" onclick="send_activity();return false">Submit</button>
        <p id="pop_message">&nbsp;</p>
      </form>
    </div>
  </div>
  </div>

  <script>
    // Join Room Pop Up Functions
    var join_room = $(".join_room_popup");
    var span = document.getElementsByClassName("close")[0];

    // Closes Join Room Popup
    function close_pop() {
      join_room.css("display", "none");
      $(".join_room_popup_content").css("height","10em");
      $("#pop_message").html("");
    }

    // Brings up Join Room Popup
    function join_room_pop() {
      join_room.css("display", "block");
    }

    // Send the user to a room with their room code and name
    myStorage = window.localStorage;

    function send_activity() {
      const room = database.ref().child("roomList/" + $("#input_number").val());

      //checks if room exists
      room.once('value', snapshot => {
        if (snapshot.exists() && $("#input_number").val() != "") {
          room.child("start").once('value', snapshot => {
            if(!snapshot.val()) {
              name_validate(room);
            }
            else {
              $(".join_room_popup_content").css("height","14em");
              $("#pop_message").html("Sorry, that room has already be started.");
            }
          });
        } else {
          $(".join_room_popup_content").css("height","14em");
          $("#pop_message").html("Sorry, we didn't find a room with that number.");
        }
      });
    };

    //checks if the username is unique, if it is, connect them to that activity
    function name_validate(roomParam) {
      roomParam.child("people/" + $("#input_name").val()).once('value', snapshot => {
        if (!snapshot.exists()) {
          console.log("User name is unique!");
          console.log("Going!");
          let name = $("#input_name").val();
          roomParam.child("people/" + name).set(true); //adds username to the database, within the room they are joining
          myStorage.setItem("name", name);
          myStorage.setItem("roomCode", $("#input_number").val());
          window.location.href = "activity.html";
          // a comment
        } else {
          $(".join_room_popup_content").css("height","14em");
          $("#pop_message").html("Sorry, that name is taken.");
        }
      });
    }
  </script>

</body>

</html>
